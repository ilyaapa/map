# Рекомендательная система

[control_model.ipynb](control_model.ipynb)\
[control_model.html](http://htmlpreview.github.io/?https://github.com/ilyaapa/map/blob/main/Recomendation%20System/control_model.html)\
[test_model.ipynb](test_model.ipynb)\
[test_model.html](http://htmlpreview.github.io/?https://github.com/ilyaapa/map/blob/main/Recomendation%20System/test_model.html)\
[service.py](service.py)


## Описание проекта

Социальной сеть обладает следующим функционалом: пользователи могут отправлять друг другу письма, создавать сообщества и в этих сообществах публиковать посты.
Также на платформе есть лента, которую пользователи могут листать и просматривать случайные записи случайных сообществ. Если пост нравится, можно поддержать автора и поставить лайк. 
Все действия пользователей сохраняются, каждая их активность, связанная с просмотром постов, записывается в базу.
Текущую ленту необходимо усовершенствовать таким образом, чтобы показывать пользователям не случайные посты, а рекомендовать их точечно каждому пользователю из всего имеющегося множества написанных постов,
учитывая индивидуальные характеристики профиля пользователя, его прошлую активность и содержимое самих постов.

В данном проекте необходимо разработать два варианта рекомендательней системы постов в социальной сети. Первый вариант с применением классических методов машинного обучения и второй с применением методов deep learning.
Также необходимо реализовать сервис,  с помщью которого можно будет провести А/В-тест, то есть разбивать пользователей на группы и для каждой из групп использовать одну из двух реализованных моделей. 
Сервис должен возвращать группу, к которой был отнесен пользователь, а также id поста, его текст и топик, в котором этот пост был опубликован.

## Навыки и инструменты

- python
- pandas
- sqlalchemy
- nltk
- sklearn
- catboost
- transformers
- torch
- fastapi
- pydantic
- hashlib
- loguru


## Итоги

В ходе выполнения проекта:
- Обучена модель рекомендательной системы с помощью библиотеки CatBoost, для признаков применялись бинарная классификация, One Hot Encoding, TF-IDF;
- Обучена модель рекомендательной системы с помощью библиотеки CatBoost, для признаков применялись векторизация и кластеризация текстов с применением методов deep learning;
- Создан сервис, позволяющий проводить А/В-тест с целью оценки изменения метрик:
  - Реализована функцию, которая по user_id пользователя определяет, в какую группу попал пользователь, используя хэш-функций из библиотеки hashlib;
  - Построение рекомендаций двумя моделями вынесено в две отдельные функции;
  - В endpoint'е используется функция для определения группы пользователя, в соответствии с которой вызывается нужная функцию для построения рекомендаций,
    в ответе endpoint'а указывается группа, в которую попал пользователь, и рекомендованные посты для этого пользователя. Также логируется, какая модель применялась.